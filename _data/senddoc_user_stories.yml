- id: GPC-SD01
  title: "Send report for correct patient"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a clinician at the federated practice"
  iwant: "to send a document containing a patient’s consultation notes  when the patient is registered at another practice within my GP federation"
  sothat: "the patient’s medical record is kept up to date with a full treatment history."
  sender: "<p><ol type=\"1\"><li>the sender system must send a federated consultation report when the patient in question is registered at another GP practice within the federation (or group of GP practices working together to deliver a service)</li><li>the sender system must follow the method stated in the specification to determine whether a patient is registered at another GP practice within the same federation. Details can be found <a href=\"senddocument_fedcon_trigger.html#defining-whether-message-should-be-sent\">here</a></li><li>if the sender system determines the registered practice is outside the GP federation (or group of GP practices), no federated consultation report is sent and usual business processes should be followed</li></ol></p>"
  receiver: "<p>N/A</p>"
  requirement1: "GPCM-SD-83"
  requirement2: "GPCM-SD-84"
  requirement3: "GPCM-SD-85"

- id: GPC-SD02
  title: "Routing the report to the correct practice"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a clinician"
  iwant: "the federated consultation report to be routed to the patient’s registered practice"
  sothat: "the patient’s medical record is kept up to date with a full history."
  sender: "<p><ol type=\"1\"><li>all federated consultation reports will use MESH automated message routing in order to ensure that the message is routed correctly to the registered practice of the patient. It is not necessary for the sender system to specify a destination MESH mailbox ID</li><li>the sender system must specify the patient’s NHS Number, Surname and Date of Birth in the message header and use these to populate the Mex-To HTTP header in the MESH endpoint lookup service</li><li>the sender system must use the allocated MESH Workflow ID associated solely with the GP Connect Send Document capability</li></ol></p>"
  receiver: "<p><ol type=\"1\"><li>where the message received is for a patient who is not registered at the GP practice, the receiver system must send a response back to the sending GP practice</li><li>the receiver system must use the allocated MESH Workflow ID associated solely with the GP Connect Send Document capability</li></ol></p>"
  requirement1: "GPCM-C-01"
  requirement2: "GPCM-SD-56"
  requirement3: "GPCM-SD-18"
  requirement4: "GPCM-SD-57"
  requirement5: "GPCM-C-02" 
  requirement6: "GPCM-SD-58" 
  
- id: GPC-SD03
  title: "Generate PDF and associated metadata"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a clinician"
  iwant: "a full and complete record of the consultation to be sent and the data entered in to the local record to exactly match what is received at the patient’s registered GP practice"
  sothat: "the patient’s medical record is kept up to date with a full history."
  sender: "<p><ol type=\"1\"><li>the sender system must include all data entered by the clinician at the federated practice into the 'Clinical notes [notes]' section of the PDF document; this includes all free text, clinical/SNOMED CT codes, dm+d codes and any other data entered relating to the consultation</li><li>the sender system must include in the message all attachments relating to the consultation</li><li>where the system does not have a concept of a consultation in its architecture, then the sender system will consider all data asserted about the patient for a specified date as part of the same consultation (this follows the same model as GP2GP)</li><li>the layout and content of the PDF must conform to the template and logical field model contained within this requirements catalogue</li><li>the version number must be displayed in the PDF in the relevant field and within the Subject of the MESH .CTL file</li><ol type=\"i\"><li>version 1 is the original report with each subsequent report that relates to the same consultation incrementing by 1</li></ol></ol></p>"
  receiver: "<p>N/A</p>"
  requirement1: "GPCM-SD-86"
  requirement2: "GPCM-SD-87"
  requirement3: "GPCM-SD-88"
  requirement4: "GPCM-SD-89"
  requirement5: "GPCM-SD-90" 
  requirement6: "GPCM-SD-91" 

- id: GPC-SD04
  title: "Receiving the federated consultation report"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a member of staff at the registered practice"
  iwant: "a full and complete report of our patient’s consultation when they are receiving care at another practice in our GP federation"
  sothat: "the patient’s medical record is kept up to date with a full history."
  sender: "<p>N/A</p>"
  receiver: "<p><ol type=\"1\"><li>the receiver system must route federated consultation reports into the practice workflow and display it as a task (add link to Generic FHIR Receiver spec here)</li><li>when displaying the federated consultation report in the practice workflow/task list, the receiver system must display the Subject from the MESH .CTL file: \"Federated consultation report for {patient name}, NHS Number {NHS Number}, seen at {Practice name}, {ODS Code}, Version {Version Number}\"</li><li>the receiver system must display all data in the same form as supplied by the sender system</li><li>the receiver system must make any attachments included with the federated consultation report available to the end user</li></ol></p>"
  requirement1: "link to Generic FHIR Receiver spec"
  requirement2: "GPCM-SD-92"
  requirement3: "GPCM-SD-90"
  requirement4: "GPCM-SD-93"
  
- id: GPC-SD05
  title: "Alert staff of errors"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a member of the admin staff at the federated practice"
  iwant: "to be informed when a federated consultation report is not sent successfully"
  sothat: "I can take appropriate measures to get the data to the patient’s registered practice."
  sender: "<p><ol type=\"1\"><li>where a federated consultation report is not successfully received/managed by the receiver system, the sender system must inform an appropriate person</li><li>where either the infrastructure or business acknowledgements, or both, are not received for a federated consultation report, the sender system must inform an appropriate person</li></ol></p>"
  receiver: "<p><ol type=\"1\"><li>the receiver system must return an error code when the processing of the message is unsuccessful</li></ol></p>"
  requirement1: "GPCM-SD-94"
  requirement2: "GPCM-SD-95"
  requirement3: "GPCM-SD-66"
  
- id: GPC-SD06
  title: "Report version number"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a clinician at the receiving GP practice"
  iwant: "to know what version/iteration of the PDF document has been received"
  sothat: "I am informed of updates to previous federated consultation reports and to understand that there are earlier versions that can be discarded/updated."
  sender: "<p><ol type=\"1\"><li>the sender system must identify if there are multiple federated consultation report documents sent for a specific consultation and patient. The version number must be displayed within the relevant section of the PDF document and in the subject of the MESH .CTL file in the format \"Federated consultation report for {patient name}, NHS Number {NHS Number}, seen at {Practice code}, {ODS Code}, Version {Version Number}\"</li><ol type=\"i\"><li>version 1 is the original report with each subsequent report that relates to the same consultation incrementing by 1</li></ol></ol></p>"
  receiver: "<p><ol type=\"1\"><li>when displaying the federated consultation report in the practice workflow/task list, the receiving system must display the Subject of the MESH .CTL file in the format \"Federated consultation report for {patient name}, NHS Number {NHS Number}, seen at {Practice code}, {ODS Code}, Version {Version Number}\"</li></ol></p>"
  requirement1: "GPCM-SD-18"
  requirement2: "GPCM-SD-91"
  requirement3: "GPCM-SD-92"
  
- id: GPC-SD07
  title: "Send federated consultation report"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "the authoring clinician"
  iwant: "the system to automate the process of generating and sending the federated consultation report to the registered practice"
  sothat: "the federated consultation report document is sent for 100% of federated consultations."
  sender: "<p><ol type=\"1\"><li>the sender system must send the federated consultation report a configurable time period after the consultation was created or last updated</li><ol type=\"i\"><li>where a consultation is updated within the configurable time period of the last update, the time delay to sending the consultation report will be from the later update</li><li>where a consultation is updated after the configurable time period (and therefore the consultation report has already been sent) a new consultation report will be sent (after the configurable time period)</li><li>each GP practice must be able to set its own a configurable time period</li><li>where a GP practice has not set its own configurable time period the value will default to three hours</li></ol></ol></p>"
  receiver: "<p>N/A</p>"
  requirement1: "GPCM-SD-96"
  requirement2: "GPCM-SD-97"
  requirement3: "GPCM-SD-98"
  requirement4: "GPCM-SD-99"
  requirement5: "GPCM-SD-100"
  
- id: GPC-SD08
  title: "Patient awareness of data sharing"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a patient"
  iwant: "to be made aware of how my data is handled"
  sothat: "so that I am fully informed of what happens to my data."
  sender: "<p><ol type=\"1\"><li>the sender organisation must ensure, as part of using this service, that the patient is made aware that the information from the consultation will be sent back to their registered GP practice</li><ol type=\"i\"><li>this requirements can be met in whichever way the sender organisation considers most appropriate for its local situation. There is no requirement for it to be met though a technical solution</li><li>where a patient does not want their consultation data to be sent back to their registered GP practice they must find an alternative care service</li></ol></ol></p>"
  receiver: "<p>N/A</p>"
  requirement1: "None applicable"
  
- id: GPC-SD09
  title: "Local Record Retention"
  source: "<a href=\"sendmessage_process.html\">Process 4.1</a>"
  as: "a clinician"
  iwant: "the original record of the consultation recorded on the local system"
  sothat: "it is available to support ongoing care of the patient and to review if there are any legal or clinical challenges about the care given."
  sender: "<p><ol type=\"1\"><li>the sender system must retain a copy of every consultation report that is sent</li><li>for every consultation where a consultation report is produced, the sender system must retain a copy of the consultation in the format is was originally recorded</li></ol></p>"
  receiver: "<p>N/A</p>"
  requirement1: ""
  requirement2: ""
  requirement3: ""